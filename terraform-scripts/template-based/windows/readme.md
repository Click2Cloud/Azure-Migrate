**Steps to perform**

### Steps to create Windows Server 2016 hosting Sales database (MSSQL Server 2017)

1. Download the files (main.tf, variables.tf and var.tfvars) to the server where terraform is installed.

2. Update var.tfvars file with required parameters for script to run.

    **vsphere_server** - This is the vCenter server IP.  
    **vsphere_user** - This is the username for vCenter.  
    **vsphere_password** - This is the password for vCenter.  
    **vsphere_datacenter** - Name of the ESXi server.  
    **vsphere_datastore** - Name of storage/container of the vCenter.  
    **vsphere_network** - The name of the network on vCenter.  
    **vsphere_resource_pool** - Name of the resource pool. If your vCenter does not contain a Resource Pool then don't change the value in var.tfvars file.  
    **vsphere_template** - Name of the Windows Server 2016 template created by you. If you have not created a template yet, create it by following the steps mentioned [here](../../../prerequisites/os/windows-template-creation.md)
    **vm_name** - NAme that you want to give to the VM.  
    **cpus** - Number of vCPUs you want to allot the the VM.
    **memory_in_mb** - Memory you want to allot to the VM (in MB).
    **disk_size** - Size of the disk which will be attached to the VM.
    **admin_password** - Login password for the VM.
    **ipv4_address** - IP address to assign to the VM.
    **ipv4_netmask** - IPv4 netmask value.
    **dns_server_list** - List of DNS servers.
    **dns_suffix_list** - DNS suffix list.
    **ipv4_gateway** - IPv4 gateway.
    **computer_name** - Computer name for the VM.
    **script_file_path** - Path to wwi-db-sql2017-installation.ps1 (The script is located in installer-scrips folder).
    
3. Go to the path where main.tf file is present using following command.
> cd <path-to-main.tf>.

4. Execute following terraform commands step by step
    * **terraform init -var-file="var.tfvars"** - This command performs several different initialization steps in order to prepare a working directory for use.
    * **terraform plan -var-file="var.tfvars"** - This command is used to create an execution plan. 
    * **terraform apply -var-file="var.tfvars"** - This command is used to apply the changes required to reach the desired state of the configuration, or the pre-determined set of actions generated by a terraform plan execution plan.
    
5. Please login to your server using server IP, Username and Password you have provided in **variables.tf**
6. After logging in perform the following steps for further installation:  
    1. Copy 2 files from installer-scripts folder to the logged in VM.  
        i) wwi-sql-sales-schema-creation.ps1  
        ii) wwi-sales-db.sql        
    2. Open PowerShell and run wwi-sql-sales-schema-creation.ps1, this will create the required Sales database.  
    3. Start SQL server Configuration manager.  
    4. Navigate to **SQL Server Configuration Manager** > **SQL Server Network Configuration** > **Protocols for MSSQLSERVER**.  
    5. Double-click TCP/IP. The TCP/IP Properties screen appears.
    6. For **Enabled** tab, select **Yes**. Then click **OK**.  
    7. Restart the MSSQL server.
    8. The database is ready to connect to the application.
    > Default password for user **sa** is set to **MSAzure#123**
    
    
### Steps to create Windows Server 2016 hosting WWI Website (Hosted on IIS)

1. Download the files (main.tf, variables.tf and var.tfvars) to the server where terraform is installed.

2. Update var.tfvars file with required parameters for script to run.

    **vsphere_server** - This is the vCenter server IP.  
    **vsphere_user** - This is the username for vCenter.  
    **vsphere_password** - This is the password for vCenter.  
    **vsphere_datacenter** - Name of the ESXi server.  
    **vsphere_datastore** - Name of storage/container of the vCenter.  
    **vsphere_network** - The name of the network on vCenter.  
    **vsphere_resource_pool** - Name of the resource pool. If your vCenter does not contain a Resource Pool then don't change the value in var.tfvars file.  
    **vsphere_template** - Name of the Windows Server 2016 template created by you. If you have not created a template yet, create it by following the steps mentioned [here](../../../prerequisites/os/windows-template-creation.md)
    **vm_name** - NAme that you want to give to the VM.  
    **cpus** - Number of vCPUs you want to allot the the VM.
    **memory_in_mb** - Memory you want to allot to the VM (in MB).
    **disk_size** - Size of the disk which will be attached to the VM.
    **admin_password** - Login password for the VM.
    **ipv4_address** - IP address to assign to the VM.
    **ipv4_netmask** - IPv4 netmask value.
    **dns_server_list** - List of DNS servers.
    **dns_suffix_list** - DNS suffix list.
    **ipv4_gateway** - IPv4 gateway.
    **computer_name** - Computer name for the VM.
    **script_file_path** - Path to wwi-app.ps1 (The script is located in installer-scrips folder).
    
3. Go to the path where main.tf file is present using following command.
> cd <path-to-main.tf>.

4. Execute following terraform commands step by step
    * **terraform init -var-file="var.tfvars"** - This command performs several different initialization steps in order to prepare a working directory for use.
    * **terraform plan -var-file="var.tfvars"** - This command is used to create an execution plan. 
    * **terraform apply -var-file="var.tfvars"** - This command is used to apply the changes required to reach the desired state of the configuration, or the pre-determined set of actions generated by a terraform plan execution plan.
    
5. Please login to your server using server IP, Username and Password you have provided in **variables.tf**
6. After logging in perform the following steps for further installation:  
    1. Copy wwi-build-app.ps1 from installer-scripts to the logged in VM.  
    2. Go to "C:/inetpub/wwroot" and open config.json file, replace SQL server details with your SQL server details.
    3. Restart the wwi-app website from IIS console.
    4. You can browse the website at localhost.
    

### Steps to create Windows Server 2008 R2 hosting Campaign database (MSSQL Server 2008 R2)

1. Download the files (main.tf, variables.tf and var.tfvars) to the server where terraform is installed.

2. Update var.tfvars file with required parameters for script to run.

    **vsphere_server** - This is the vCenter server IP.  
    **vsphere_user** - This is the username for vCenter.  
    **vsphere_password** - This is the password for vCenter.  
    **vsphere_datacenter** - Name of the ESXi server.  
    **vsphere_datastore** - Name of storage/container of the vCenter.  
    **vsphere_network** - The name of the network on vCenter.  
    **vsphere_resource_pool** - Name of the resource pool. If your vCenter does not contain a Resource Pool then don't change the value in var.tfvars file.  
    **vsphere_template** - Name of the Windows Server 2008 R2 template created by you. If you have not created a template yet, create it by following the steps mentioned [here](../../../prerequisites/os/windows2008R2-template-creation.md)
    **vm_name** - NAme that you want to give to the VM.  
    **cpus** - Number of vCPUs you want to allot the the VM.
    **memory_in_mb** - Memory you want to allot to the VM (in MB).
    **disk_size** - Size of the disk which will be attached to the VM.
    **admin_password** - Login password for the VM.
    **ipv4_address** - IP address to assign to the VM.
    **ipv4_netmask** - IPv4 netmask value.
    **dns_server_list** - List of DNS servers.
    **dns_suffix_list** - DNS suffix list.
    **ipv4_gateway** - IPv4 gateway.
    **computer_name** - Computer name for the VM.
    **script_file_path** - Path to wwi-db-sql2008R2-installation.ps1 (The script is located in installer-scrips folder).
    
3. Go to the path where main.tf file is present using following command.
> cd <path-to-main.tf>.

4. Execute following terraform commands step by step
    * **terraform init -var-file="var.tfvars"** - This command performs several different initialization steps in order to prepare a working directory for use.
    * **terraform plan -var-file="var.tfvars"** - This command is used to create an execution plan. 
    * **terraform apply -var-file="var.tfvars"** - This command is used to apply the changes required to reach the desired state of the configuration, or the pre-determined set of actions generated by a terraform plan execution plan.
    
5. Please login to your server using server IP, Username and Password you have provided in **variables.tf**
6. After logging in perform the following steps for further installation:  
    1. copy 2 files from installer-scripts folder to the logged in VM.  
        i) wwi-campaign.ps1      
        ii) wwi-campaign-schema.sql      
    2. Run the setup.exe file located at "C:\Users\Administrator" and perform the SQL 2008 R2 installation.   
    3. Navigate to **SQL Server Configuration Manager** > **SQL Server Network Configuration** > **Protocols for MSSQLSERVER**.  
    4. Double-click TCP/IP. The TCP/IP Properties screen appears.
    5. For **Enabled** tab, select **Yes**. Then click **OK**.   
    6. Open PowerShell and run wwi-campaign.ps1, this will create the required Campaign database and tables. 
    7. Start SQL server Configuration manager.          
    8. The database is ready to connect to the application.
    > Default password for user **sa** is set to **MSAzure#123**